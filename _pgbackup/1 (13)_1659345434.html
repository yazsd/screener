<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script type="text/javascript">
		function load(){
			console.log("here");
			
			var drawRow = function(symbol, index){
				console.log(symbol);
				$.ajax({
					type:'get',
					url:'https://api.binance.com/api/v1/depth?symbol='+ symbol["pair"]+'&limit=200',
					success: function(item) {
						
						console.log(item);
	               	    var money = 0;
	               	    var eth_money=0;
	               	    var coin_number=0;
	               	    var coin_number_list=[];
	               	    var biggest_coin_number=0;
	               	    var ask_max = 0;
	               	    var bid_max= 0;
	               	    var ask_index = 0;
	               	    var bid_index = 0;
	               	    for (var j = 0; j < item.bids.length; j++) {

	           	            if(Number(item.asks[j][1]) > ask_max){
	           	            	 ask_index=j;
	           	            	 ask_max=Number(item.asks[j][1]);
	           	                 }
	               	    	if(Number(item.bids[j][1]) > bid_max)
               	    			{ 
               	    			  bid_index=j;
               	    			  bid_max=Number(item.bids[j][1]);

               	    			}
               	    
	               	    }
	               	    console.log(ask_max);
	               	    console.log(bid_max);
	               	    console.log(ask_index);
	               	    console.log(bid_index);

                        var actual_price=((Number(item.bids[bid_index][0])*Number(item.bids[bid_index][1]))+(Number(item.asks[ask_index][0])*Number(item.asks[ask_index][1])))/2;
           	   			var html = "<tr>";
           	   			html += '<td>' + symbol["baseAsset"] + '/' + 'USDT'+'</td>';
	               	    html += '<td class="money">' +( actual_price/1000).toFixed(4) + 'k' + '</td>';
	               	    html += '<td>' + Math.max(Number(item.bids[bid_index][0]),Number(item.asks[ask_index][0])).toFixed(4)+ '</td>';
	               	    html += '<td>' + (Math.max(Number(item.bids[bid_index][1]),Number(item.asks[ask_index][1]))/1000).toFixed(4)+ 'k' + '</td>';
	               	    html += '<td>' + (((Math.max(Number(item.bids[bid_index][0])*Number(item.bids[bid_index][1]),Number(item.asks[ask_index][0])*(item.asks[ask_index][1]))-actual_price)/actual_price)*100).toFixed(4)	+ '%' + '</td>';
	               	    html += "</tr>";
	               	    var tbody = symbol["contractType"] == "PERPETUAL" ? "#tbody1" : "#tbody2";
	               	   	$(tbody).append(html);
	               	   },
	               	error: function() {
	               		console.log("");
	               	}
               });
			}

 			$.ajax({
               	type:'get',
               	url:'https://testnet.binancefuture.com/fapi/v1/exchangeInfo',
               	success:function(data) {
               		$("tbody").empty();
               		data.symbols.forEach(drawRow);
               }
            });
 		  }
	 $(document).ready(function(){
	 	 load();
		   
         $("button").on('click', function(e){
            	e.preventDefault();
  
            	var id=$(this).attr("id");
            	$("button").attr("class","btn btn-success");
            	$(this).attr("class","btn btn-information");
            	if (id == "one" ) {
            		location.reload(true);	
            	}
            	if (id == "two" ) {
            		var money=$(".money");
            		for (var i = 0; i < money.length; i++) {
            			var number=money[i].innerText;
            			var number1=number.replace("k","");
            			if ((number1 > 100) && (number1 < 250)) {
            			    var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","");	
            			}
            			else{
            				var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","none");
            			}
            		}
            		
            	}
            	if (id == "three" ) {
            		var money=$(".money");
            		for (var i = 0; i < money.length; i++) {
            			var number=money[i].innerText;
            			var number1=number.replace("k","");
            			if ((number1 > 250) && (number1 < 500)) {
            			    var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","");	
            			}
            			else{
            				var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","none");
            			}
            		}
            		
            	}
            	if (id == "four" ) {
            		var money=$(".money");
            		for (var i = 0; i < money.length; i++) {
            			var number=money[i].innerText;
            			var number1=number.replace("k","");
            			if ((number1 > 500) && (number1 < 1000)) {
            			    var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","");	
            			}
            			else{
            				var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","none");
            			}
            		}
            	}
            	if (id == "five" ) {
            		var money=$(".money");
            		for (var i = 0; i < money.length; i++) {
            			var number=money[i].innerText;
            			var number1=number.replace("k","");
            			if (number1 > 1000) {
            			     var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","");	
            			}
            			else{
            				var aaa=$(money[i]).parents("tr");
            				$(aaa).css("display","none");
            			}
            		}	
            	}
            });
         setInterval(load, 60000);


		});
       

	</script>
	<title>
	Cryptor Screeen
	</title>
</head>
<body>
  <div  style="height: 650px;width:100%;display: flex;">
  	<div style="overflow-y: scroll;">
  		<h2>Spot</h2>
		<table class="table table-striped"> 
			<thead>
				<th>Coin Name</th>
				<th>Dollars in Level</th>
				<th>Price</th>
				<th>Coins in Level</th>
				<th>Distance to level</th>
			</thead>
			<tbody id="tbody1">
			</tbody>
		</table>
    </div>
    <div style="overflow-y:scroll;">
    	<h2>Futures</h2>
    	<table class="table table-dark table-striped">
		<thead>
			<th>Coin Name</th>
			<th>Dollars in Level</th>
			<th>Price</th>
			<th>Coins in Level</th>
			<th>Distance to level</th>
		</thead>
		<tbody id="tbody2">
		</tbody>
	</table>
    </div> 
  </div>
  <div class="filter" style="margin-top: 30px;margin-left: 30px;">
	  <button type="button" class="btn btn-success" id="one">From</button>
	  <button type="button" class="btn btn-success" id="two">100k-250k</button>
	  <button type="button" class="btn btn-success" id="three">250k-500k</button>
	  <button type="button" class="btn btn-success" id="four">500k-1kk</button>
	  <button type="button" class="btn btn-success" id="five">From 1kk</button>    
  </div>
</body>
</html>